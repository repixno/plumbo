<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
	
	<tal:block metal:use-macro="../../${templates}/common.html/head" tal:define="global pagetitle">
		<tal:block i18n:translate="">Create gift</tal:block> - <tal:block tal:content="selected/product/title" />
	</tal:block>
	
	
	<link rel="stylesheet" href="${static:css/gift.css}?${version}" type="text/css" media="screen, projection" />

	
		<style type="text/css">

		.add_text {
			height: 250px;
		}
		@font-face {
			font-family: "ArBerkley";
			src: url('/fonts/ARBERKLEY.ttf');
			/*src: url('/fonts/andbasr-webfont.eot?#iefix') format('embedded-opentype'),
				 url('/fonts/andbasr-webfont.woff') format('woff'),
				 url('/fonts/andbasr-webfont.ttf') format('truetype'),
				 url('/fonts/andbasr-webfont.svg#andika_basicregular') format('svg');*/
			font-weight: normal;
			font-style: normal;
		}
		
		@font-face {
			font-family: "billabong";
			src: url('/fonts/Billabong.ttf');
			font-weight: normal;
			font-style: normal;
		}
		
		@font-face {
			font-family: "lucida";
			src: url('/fonts/LHANDW.TTF');
			font-weight: normal;
			font-style: normal;
		}
		#ar-berkley-label{
			font-family: ArBerkley;
		}
		#billabong-label{
			font-family: billabong;
		}
		#lucida-label{
			font-family: lucida;
		}
		label{
            font-weight: bold!important;
        }
		input.namefield{
			font-size: 1.8em;
			padding: 5px 0 5px 5px;
			border: 1px solid #003399; 
		}
		
		input[disabled=disabled]{
			border: 1px solid #ccc;
		}
		
		div.selectedborder{
			border:solid 2px  #003399;
		}
		label.selectedborder{
			border:solid 2px  #003399;
		}
		
		.selectedclip{
			border: 'dashed 4px red'
		}
		
		.draggable
		{
			display: -moz-inline-stack;
			display: inline-block;
			vertical-align: top;
			zoom: 1;
			cursor: hand; 
			cursor: pointer;
		}
		
		.resizable
		{
			/*width: 200px; */
			/*border: 1px solid #bb0000;*/  
		}
		
		
		.activeText{
			border: 4px dashed rgb(55, 180, 74);
		}
		
		.resizable img
		{
			width: 100%;   
		}
		
		.ui-resizable-handle 
		{
			/*background: #f5dc58;
			border: 1px solid #FFF;*/
			width: 50px;
			height: 50px;
			
			z-index: 2;
		}
		.textholder .ui-resizable-handle 
		{
			width: 20px;
			height: 20px;
			
			z-index: 2;
		}
		
		.textholder .ui-resizable-ne
		{
			top: -15px;
			right: -15px;
		}
		.textholder .ui-resizable-nw
		{
			top: -5px;
		}
		
		
		.ui-resizable-handle{
			display: none;
		}
		
		.ui-resizable-se
		{
			right: -5px;
			bottom: -5px;
		}
		.resizing{
			cursor: ne-resize!important;
		}
		.ui-resizable-nw{
			cursor: pointer !important;
		}
		div.colorPicker-picker {
			height: 32px;
			width: 32px;
			padding: 0 !important;
			border: 1px solid #ccc;
			background: url(${static:}gfx/icons/arrow.gif) no-repeat top right;
			cursor: pointer;
			line-height: 16px;
			font-size:0.75em;
			font-weight:bold;
			text-align: center;
		  }
		  
		  div.colorPicker-palette {
			width: 210px;
			position: absolute;
			border: 1px solid #598FEF;
			background-color: #EFEFEF;
			padding: 2px;
			z-index: 9999;
		  }
			div.colorPicker_hexWrap {width: 100%; float:left }
			div.colorPicker_hexWrap label {font-size: 95%; color: #2F2F2F; margin: 5px 2px; width: 25%}
			div.colorPicker_hexWrap input {margin: 5px 2px; padding: 0; font-size: 95%; border: 1px solid #000; width: 65%; }
		  
		  div.colorPicker-swatch {
			height: 16px;
			width: 16px;
			border: 1px solid #000;
			margin: 2px;
			float: left;
			cursor: pointer;
			line-height: 12px;}
			
            
            #choose-template .template-thumb {
                width: 50px;
                height: 50px;
                border: 0px solid #fff;
                outline: 1px solid #ccc;
                float: left;
                margin: 10px;
            }
            
            .prev{
                float:left;
                margin: 5px;
            }
            
			.image-wrapper {
                overflow: hidden;
                position: absolute;
                top: 0;
                left: 0;
                height: 100%;
                width: 100%;
                z-index: 90;
            }
			.previmg{
                position: relative;
                z-index: 100;
                
            }
			
			.vimpeltext{
				text-transform:uppercase;
			}
            .prevtext{
				color: #333;
				position: relative;
				bottom: 2px;
                widht: 100%;
                height: 100%;
                text-align: center;
                font-size: 55px;
				text-transform:uppercase;
            }
			.colorPicker-picker{
				float: left;
				margin: 0px 5px;
			}
	  </style>
</head>

<body>
	
	<div metal:use-macro="../../common/loader.html/fullscreen" />
	
	<div metal:use-macro="../../${templates}/common.html/top" />
	
	<div class="container create-gift">


	<div class="row" id="gift-editor">
        <h4 class="bottom " tal:condition="exists:selected/product/title">
            <tal:block tal:content="selected/product/title" tal:condition="selected/product/title"/>
        </h4>
		<input type="hidden" value="${selected/product/id}" name="productid" id="productid"/>
		<input type="hidden" value="${selected/productoptionid}" name="productoptionid" id="productoptionid"/>

	
		<tal:block tal:repeat="page selected/template/pages">
			
			<div class="page" tal:condition="equal:repeat/page/number,1">
                <div class="row">
                    <div class="col-md-12">
                        <div class="prev" style="position: relative; overflow: hidden; margin-left: 0px; width: 75px; height: 75px;">
                            <img id="prev1" class="previmg" src="${static:}images/gifttemplates/thumbs/width/75/${page/fullsize_src}"/>
                            <div class="image-wrapper">
                                <img class="previmage" src="" alt="?" style="width: 401px; height: 401px; left: 27px; top: 30px; margin-left: 0px; margin-top: 0px;"/>
                            </div>
                            
                        </div>
                        <div class="prev textprev text1" style="background: #fff url(${static:}images/gifttemplates/thumbs/width/75/${page/fullsize_src});position: relative; overflow: hidden; margin-left: 0px; width: 75px; height: 75px;">
                           <div class="prevtext">T</div>
                        </div>
                        <div class="prev prevlast" style="position: relative; overflow: hidden; margin-left: 0px; width: 75px; height: 75px;">
                            <img id="prev1" class="previmg" src="${static:}images/gifttemplates/thumbs/width/75/${page/fullsize_src}"/>
                            <div class="image-wrapper">
                                <img class="previmage" src="" alt="?" style="width: 401px; height: 401px; left: 27px; top: 30px; margin-left: 0px; margin-top: 0px;"/>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row top-15">
                    
          
                    <div class="col-md-4">
                        <div class="panel panel-primary">
                            <div class="panel-heading">
                              <h3 class="panel-title">1. <span  i18n:translate="">Choose template</span></h3>
                            </div>
                            <div class="panel-body">
                                <div class="functions" id="choose-template">
                                    <div>
                                        <tal:block tal:repeat="gifttemplate collections/gifttemplates">
                                            <div class="template-thumb">
                                                
                                                <a tal:attributes="href string:/create/gift/${selected/productid}/${selected/productoptionid}/${gifttemplate/id}/${selected/image/id}">
                                                    <tal:block tal:repeat="page gifttemplate/pages">
                                                        <tal:block tal:condition="equal:repeat/page/number,1">
                                                        
                                                            <input 
                                                                type="hidden" class="websize_x" name="malid" value="${page/websize_x}" 
                                                                tal:condition="exists:page"/>
                                                            <input 
                                                                type="hidden" class="websize_y" name="malid" value="${page/websize_y}" 
                                                                tal:condition="exists:page"
                                                            />
                                                            
                                                            <tal:block tal:condition="page/fullsize_src">
                                                                <img 
                                                                    src="${static:}images/gifttemplates/thumbs/squareaspect/75/${page/fullsize_src}" 
                                                                    width="50" height="50"
                                                                    id="malid_${gifttemplate/id}" alt="eurofoto" class="mal"
                                                                />
                                                                <script type="text/javascript">
                                                                    $('#malid_${gifttemplate/id}').data('websize_x', '${page/websize_x}');
                                                                    $('#malid_${gifttemplate/id}').data('websize_y', '${page/websize_y}');
                                                                    $('#malid_${gifttemplate/id}').data('fullsize_pos_x', '${page/fullsize_pos_x}');
                                                                    $('#malid_${gifttemplate/id}').data('fullsize_pos_y', '${page/fullsize_pos_y}');
                                                                    $('#malid_${gifttemplate/id}').data('fullsize_pos_dx', '${page/fullsize_pos_dx}');
                                                                    $('#malid_${gifttemplate/id}').data('fullsize_pos_dy', '${page/fullsize_pos_dy}');
                                                                    $('#malid_${gifttemplate/id}').data('fullsize_x', '${page/fullsize_x}');
                                                                    $('#malid_${gifttemplate/id}').data('fullsize_y', '${page/fullsize_y}');	
                                                                    
                                                                </script>
                                                                <input type="hidden" class="malid" name="malid" value="${gifttemplate/id}" />
                                                                <input type="hidden" class="malpageid" name="malpageid" value="${page/malpageid}" />
                                                            </tal:block>
                                                            
                                                            <tal:block tal:condition="not:page/fullsize_src">
                                                                <div class="empty-template-thumb">
                                                                <img 
                                                                    src="${static:}images/gifttemplatesweb/thumbs/blankbox/50x50/${selected/template/id}.png" 
                                                                    width="50" height="50"
                                                                    id="malid_${gifttemplate/id}"
                                                                />
                                                                </div>
                                                            </tal:block>
                                                            
                                                            <input type="hidden" class="malid" name="malid" value="${gifttemplate/id}" />
                                                            <input type="hidden" class="malpageid" name="malpageid" value="${page/malpageid}" />
                                                            
                                                        </tal:block>
                                                    </tal:block>
                                                </a>
                                                <a class="highres display-none" href="${static:}images/gifttemplates/thumbs/width/630/${page/fullsize_src}"></a>
                                            </div>
                                        </tal:block>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        
                        <div class="panel panel-primary">
                            <div class="panel-heading">
                              <h3 class="panel-title">2. Velg Tekst</h3>
                            </div>
                            <div class="panel-body form-inline">
                              <input type="text" class="form-control vimpeltext" name="name" placeholder="Velg tekst for vimpelrekken" maxlength="13"/>
							  <input id="new-text-color" class="iColorPicker form-control" value="#333333" type="text" style="width:100px; display: inline"/>
							  <button class="btn btn-primary form-control">Oppdater text</button>
                            </div>
                        </div>
                        
                        
                        <div class="panel panel-primary">
                            <div class="panel-heading">
                              <h3 class="panel-title">3. <span i18n:translate="">Choose photo</span></h3>
                            </div>
                            <div class="panel-body">
                              <div class="row span4 text-left" style="margin-left: 0px;">
                                    <h4 class="hidden-phone">1: Last opp bilder</h4>
                                    <div class="btn btn-primary fileinput-button" style="position: relative">
                                        <span>Velg bilde</span>
                                        <!-- The file input field used as target for the file upload widget -->
                                        <input id="fileupload" type="file" name="files[]"  data-url="/api/1.0/upload/stabburet" accept="image/jpeg"  />
                                    </div>
                                </div>
                                <div id="progress" class="progress" style="display: none;">
                                    <div class="progress-bar progress-bar-success"></div>
                                </div>
                                <div id="upload-queue" style="padding:5px 0px;">
                                    
                                </div>
                                <h4 i18n:translate="">Click on the image you want to use.</h4>
                                <div id="transfer-status" class="display-none small quiet">
                                    <p class="right">
                                        <a href="#" class="abort negative display-none" id="transfer-stop" i18n:translate="">Cancel upload</a> 
                                    </p>
    
                                    <span id="uplspeed" style="float: right;">0 KB/s</span>
                                    <div id="progressbar-total" style="height: 25px"></div>
                                    <div id="upload-queue">
                                        <div id="upload-master" style="display:none;">
                                            <img style="max-width: 96px;" src="${static:gfx/gui/ajax-loader-big.gif}" alt="" />
                                        </div>
                                    
                                        <div>
                                            <div class="progressbar" style="height: 10px"></div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="photos">
                                
                                    <tal:block tal:condition="session/loggedin">
                                        <label for="select-album" i18n:translate="">Choose album</label>
                                        <select id="select-album">
                                          <optgroup label="My albums" tal:condition="gt:albums/length,0" i18n:attributes="label">
                                         <tal:block tal:repeat="album albums">
                                             <option value="${album/id}" tal:condition="exists:album/title">
                                                <tal:block tal:content="shorten:album/title;18" tal:condition="album/title" />
                                             </option>
                                         </tal:block>
                                       </optgroup>
                                       <optgroup label="My Friends Albums" tal:condition="gt:sharedAlbums/length,0" i18n:attributes="label">
                                        <tal:block tal:repeat="sharedalbum sharedAlbums">
                                            <option value="${sharedalbum/id}" tal:condition="exists:sharedalbum/title">
                                               <tal:block tal:content="shorten:sharedalbum/title;18" tal:condition="sharedalbum/title" />
                                            </option>
                                        </tal:block>
                                       </optgroup>
                                        </select>
                                        <div id="btnUpload"></div>
                                    </tal:block>
                                    
                                    <tal:block tal:condition="not:session/loggedin">
    
                                        <div class="prepend-top center append-bottom" style="margin-left: 50px">
                                            <div id="btnUpload"></div>
                                        </div>
                                        <h5 i18n:translate="">Sign in to get photos from your account</h5>
                                        <tal:block metal:use-macro="../common.html/quicklogin" />
                                    
                                    </tal:block>
                                    
                                    <div id="album-images">
                                        
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div> <!-- end left side -->
                    <div class="col-md-5">
                        <div class="functions col-md-12 last">
                            <div class="col-md-12 buttons form-inline">
                                <button class="form-control zoom-in" i18n:translate="">Zoom in</button>
                                <button class="form-control zoom-out" i18n:translate="">Zoom out</button>
                                <input type="range" class="zoom-range form-control" />
                                <button class="form-control reset">Reset</button>
                            </div>
                        </div>
                        <div class="col-md-12 last info">
                            <p class="top quiet" i18n:translate="">Click and drag your image to move it around.</p>
                        </div>
                        
                        
                        <input type="hidden" id="initMalpageid" name="malpageid" value="${page/malpageid}" tal:condition="exists:page"/>
                        <input type="hidden" id="initMalid" name="malid" value="${selected/template/id}" tal:condition="exists:page"/>
                        <input type="hidden" id="websize_x" name="malid" value="${page/websize_x}" tal:condition="exists:page"/>
                        <input type="hidden" id="websize_y" name="malid" value="${page/websize_y}" tal:condition="exists:page"/>
                        
                        
                        <div class="col-md-12 hide" id="gift-editor-wrapper">
                            
                            <div tal:condition="equal:selected/productoption/urlname,brodering" class="bordering-preview">
                                
                                <img id="borderingpreview" src="http://marie.eurofoto.no/create/gift/broderingpreview"/>
                                
                            </div>
                            
                            <div class="template" id="template-wrapper">
                            
                            <div id="helper">&nbsp;</div>
                            
                            <tal:block condition="page/fullsize_src">
                                <img id="template" class="highrestemplate" 
                                    src="${static:}images/gifttemplates/thumbs/width/${page/websize_x}/${page/fullsize_src}" 
                                />
                            </tal:block>
                            
                            <tal:block condition="not:page/fullsize_src">
                                <img id="template" class="highrestemplate" 
                                    src="${static:}images/gifttemplatesweb/thumbs/blankbox/${page/websize_x}x${page/websize_y}/${selected/template/id}.png" 
                                />
                            </tal:block>
                            
    
                            <!-- finds other template if not set -->
                            <tal:block condition="not:page/fullsize_src">
                                <tal:block tal:repeat="gifttemplate collections/gifttemplates">
                                    <tal:block tal:condition="equal:repeat/gifttemplate/number,1" tal:repeat="page gifttemplate/pages">
                                        <input type="hidden" id="initMalid" name="malid" value="${gifttemplate/id}" tal:condition="exists:gifttemplate"/>
                                        <tal:block tal:condition="equal:repeat/page/number,1">
                                            <tal:block tal:condition="page/fullsize_src">
                                                <img id="template" class="highrestemplate" 
                                                    src="${static:}images/gifttemplates/thumbs/width/630/${page/fullsize_src}" alt="template"
                                                />
                                                <input type="hidden" id="initMalid" name="malid" value="${page/websize_x}" />
                                                <input type="hidden" id="initMalid" name="malid" value="${page/websize_y}" />
                                                <input type="hidden" id="initMalid" name="malid" value="${gifttemplate/id}" />
                                                <input type="hidden" id="initMalpageid" name="malpageid" value="${page/malpageid}" />
                                            </tal:block>
                                            <tal:block tal:condition="not:page/fullsize_src">
                                                <img id="template" 
                                                    class="highrestemplate" 
                                                    src="${static:}gfx/404/no_template.png" alt="no template"
                                                />
                                            </tal:block>
                                        </tal:block>
                                    </tal:block>
                                </tal:block>
                            </tal:block>
                            <div id="image-wrapper">
                                <tal:block tal:condition="selected/imageid">
                                    <img id="image"	src="/images/stream/image/${selected/image/id}/630/400" alt="?"/>
                                    <input type="hidden" id="selected-image" value="${selected/imageid}" />
                                </tal:block>
                                <tal:block tal:condition="not:selected/imageid">
                                    <img id="image" class="noimage" alt="no image" src="/layout_grafikk/pixblank.gif" />
                                    <input type="hidden" id="selected-image" value="0" />
                                </tal:block>
                            </div>
                            </div>
                            
                        </div>
                        
                        <div class="display-none">
                            <!-- Article about how to do this 04c79f9a-fc81-4276-994c-42328ece2208 -->
                        </div>
                        
                    
                    
                    <!-- store the values -->
                    <input type="hidden" id="original-template-width" class="coordinate" value="${page/fullsize_x}"/>
                    <input type="hidden" id="original-template-height" class="coordinate" value="${page/fullsize_y}"/>
                    <input type="hidden" id="original-pos-x" class="coordinate" value="${page/fullsize_pos_x}"/>
                    <input type="hidden" id="original-pos-y" class="coordinate" value="${page/fullsize_pos_y}"/>
                    <input type="hidden" id="original-pos-dx" class="coordinate" value="${page/fullsize_pos_dx}"/>
                    <input type="hidden" id="original-pos-dy" class="coordinate" value="${page/fullsize_pos_dy}"/>
                    </div>
                    
                    <div class="col-md-3">
                        <div class="box">
                            <h4 i18n:translate="">Choose quantity</h4>
                            <div class="prepend-top append-bottom">
                                <input type="checkbox" name="red-eye" id="red-eye"/>
                                <label for="red-eye">
                                    <tal:block i18n:translate="">Please remove red eyes for me.</tal:block>
                                    <span class="quiet small">(Kr <span id="redeye-price"></span>)</span>
                                </label>
                            </div>
                            
                            <div class="right">
                                Kr <span class="price" id="gift-price"><tal:block tal:content="formatprice:selected/productoption/prices/0/price"/></span>
                                <label for="gift-quantity"></label>
                                <input type="text" class="quantity" id="gift-quantity" value="1"/>
                                <button class="call-to-action" id="add-gift-to-cart" i18n:translate="">Add to cart</button>
                            </div>
                        </div>
                    </div>
                
                </div>
            </div>
		</tal:block>
	</div>
	<hr class="space clearfix clear"/>
</div>
		
<div class="footer">
	<div class="container">
		<div metal:use-macro="../../${templates}/common.html/footer" />
	</div>
</div>

<script src="${static:}js/jqupload/js/jquery.iframe-transport.js?${version}"></script>
<!-- The basic File Upload plugin -->
<script src="${static:}js/jqupload/js/jquery.fileupload.js?${version}"></script>
<script type="text/javascript">
var ajaxLoader = '<tal:block tal:content="static:gfx/gui/ajax-loader.gif" />';
var bigajaxLoader = '<tal:block tal:content="static:gfx/gui/ajax-loader-big.gif" />';
var bigajaxLoaderGray = '${static:gfx/gui/ajax-loader-gray.gif}';
var noImagesText = '<tal:block i18n:translate="">No images</tal:block>';
var deleteText = '<tal:block i18n:translate="">Delete</tal:block>';
var staticurl = '${static:}';
var maxHeight = 450;
var maxtemplatewidt = 630;
var productoptionid = ${selected/productoptionid};
var websize_x = '${page/websize_x}';
var websize_y = '${page/websize_y}';
var staticsite = "${static:}";
var prevtemplate = '';


$( function(){
    
    prevtemplate = $('#prev1').attr('src');
	
	$('#new-text-color').colorPicker();
	
	});

</script>




<script src="${static:js/jquery.colorPicker.min.js}?${version}" type="text/javascript"></script>
<script src="${static:js/jquery.panzoom.min.js}?${version}" type="text/javascript"></script>
<script src="${static:js/vimpelrekke.js}?${version}" type="text/javascript"></script>
<script src="${static:}js/jqupload/js/jquery.iframe-transport.js?${version}"></script>
<!-- The basic File Upload plugin -->
<script src="${static:}js/jqupload/js/jquery.fileupload.js?${version}"></script>
<!-- Google Code for Gavegenerator - steg 2 Conversion Page -->
<script type="text/javascript">
<!--
var google_conversion_id = 1070265469;
var google_conversion_language = "no";
var google_conversion_format = "2";
var google_conversion_color = "ffffff";
var google_conversion_label = "WBXuCKXBxAEQ_eir_gM";
var google_conversion_value = 0;
//-->
</script>
<script type="text/javascript" src="http://www.googleadservices.com/pagead/conversion.js">
</script>
<noscript>
<div style="display:inline;">
<img height="1" width="1" style="border-style:none;" alt="" src="http://www.googleadservices.com/pagead/conversion/1070265469/?label=WBXuCKXBxAEQ_eir_gM&amp;guid=ON&amp;script=0"/>
</div>
</noscript>
</body>
</html>