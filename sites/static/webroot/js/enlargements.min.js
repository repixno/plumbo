function require(a){document.write('<script type="text/javascript" src="'+a+'"></script>')}function loginDialog(){return $("#loginDialog").dialog({modal:!0,width:500,height:320,buttons:{Login:function(){$("#loginDialog form").submit()}}}),$("#loginDialog").dialog("open"),!1}function uploadOneImageDialog(){return $("#uploadOneImageDialog").dialog({modal:!0}),!1}function imagePicker(){return imagePickerLoaded?$("#imagePicker").dialog("open"):$("#imagePicker").dialog({width:950,height:570,position:{my:"top",at:"top",of:$("#jau")},modal:!0,resizable:!1,draggable:!1,open:function(){$("#imagePicker .albums").append(loader);var a=$.ef("albums.enum_new");a.result&&!imagePickerLoaded&&(imagePickerLoaded=!0,$("#imagePicker .loader").remove(),$(a.albums).each(function(a,b){$("#imagePicker ul.albums").append($("<li/>").append($("<a/>",{href:"#",text:shorten(b.title,22),title:b.title,click:function(){$("#imagePicker ul.albums li a.selected").removeClass("selected"),$(this).addClass("selected"),loadAlbum($(this),b,"#imagePickerImages")}}))),a==0&&($(this).addClass("selected"),loadAlbum($(this),b,"#imagePickerImages"))}))}}),!1}function loadImage(){var a=new Image;a.src=$("#cropbox").attr("src");var b=$("#x1").val(),c=$("#y1").val(),d=$("#bid").val(),e={x:b,y:c,id:d};currentImage=e,$(a).load(function(){previewHeight=a.height,previewWidth=a.width,previewHeight>previewWidth?$("#portrait").click():$("#landscape").click(),updateOnChange($("#printtype").val())}),$("#add-to-cart").removeClass("disabled"),$(".startup").hide()}function pickImage(a){$("#imagePicker").dialog("close");var b=new Image;b.src=a.screensize,$(b).load(function(){$("#cropbox, #previewimage").attr("src",a.screensize),currentImage=a,previewHeight=b.height,previewWidth=b.width,previewHeight>previewWidth?$("#portrait").click():$("#landscape").click(),updateOnChange($("#printtype").val())}),$("#add-to-cart").removeClass("disabled"),$(".startup").hide()}function pickUploadedImage(a){var b=new Image;b.src=a.screensize,$(b).load(function(){$("#cropbox, #previewimage").attr("src",a.screensize),currentImage=a,previewHeight=b.height,previewWidth=b.width,previewHeight>previewWidth?$("#portrait").click():$("#landscape").click(),updateOnChange($("#printtype").val())}),$("#add-to-cart").removeClass("disabled"),$(".startup").hide()}function loadAlbum(a,b,c){$(c).append(loader);var d=!1;return $.ef("album.images.enum",{albumid:b.id},function(a){$(c).empty(),$(a.images).each(function(a,b){console.log(b),$(c).append($("<li/>").append($("<a/>",{href:"#",click:function(){return pickImage(b),!1}}).append('<img src="'+b.thumbnail+'" />')))})}),d}function changeSize(a,b){var c=a,d=c.split("x");printheight=d[0],printwidth=d[1],oriantation=$("input[name='oriantation']:checked").val();if(oriantation=="portrait"){var e=printwidth;printwidth=printheight,printheight=e}updateCrop(printheight,printwidth),updateArtnr()}function updateOnChange(a){console.log(a);if(a==2.5)var b=$("#canvas2cm").val();else if(a==4)var b=$("#canvas4cm").val();else if(a=="2x2")var b=$("#gallery2x2").val();else if(a=="1x3")var b=$("#gallery1x3").val();var c=b.split("x");printheight=c[0],printwidth=c[1],oriantation=$("input[name='oriantation']:checked").val();if(oriantation=="portrait"&&a!="1x3"){var d=printwidth;printwidth=printheight,printheight=d}updateCrop(printheight,printwidth),updateArtnr()}function change_printsize(a){$(".select").hide(),$(".selectedsize").removeClass("selectedsize"),a==2.5?($(".select-2cm").show(),$(".select-2cm").addClass("selectedsize")):a==4?($(".select-4cm").show(),$(".select-4cm").addClass("selectedsize")):a=="2x2"?($(".select-2x2").show(),$(".select-2x2").addClass("selectedsize")):a=="1x3"&&($(".select-1x3").show(),$(".select-1x3").addClass("selectedsize")),updateOnChange(a)}function updateCrop(a,b){printtype=$("#printtype").val(),printtype=="2x2"||printtype=="1x3"?framedepth=4:framedepth=printtype,b=parseFloat(b)+parseFloat(framedepth)*2,a=parseFloat(a)+parseFloat(framedepth)*2,b-a==0?$(".oriantationval").hide():printtype=="1x3"?($(".oriantationval").hide(),$("#landscape").click()):$(".oriantationval").show();var c=previewHeight,d=previewWidth,e=c/d,f=a/b;if(b>a)if(e>f)var g=d,h=d*(a/b);else var h=c,g=c/(a/b);else if(e<f)var h=c,g=c/(a/b);else var g=d,h=d*(a/b);var i=(d-g)/2;g=parseInt(i)+parseInt(g);var j=(c-h)/2;h=parseInt(j)+parseInt(h);var k=$("img#cropbox").imgAreaSelect({x1:i,y1:j,x2:g,y2:h,instance:!0,aspectRatio:b+":"+a,handles:!0,keys:!0,onInit:updateBorderMove,onSelectChange:updateBorderMove}),l=k.getSelection();l.width>0&&(currentSelection=l,updateBorder(l.width,l.height))}function updateBorderMove(a,b){updateBorder(b.width,b.height),currentSelection=b}function updateBorder(a,b){var c=printwidth,d=0;printtype=$("#printtype").val(),printtype=="2x2"||printtype=="1x3"?d=4:d=printtype;var e=d/(parseFloat(c)+parseFloat(d)*2)*a;e==0?(e=1,cropOffset=0):cropOffset=2;var f=a,g=b;$(".imgareaselect-border1").attr("style","border: solid "+e+"px #000;width: "+f+"px;height: "+g+"px;"),$(".gallery-handle").remove();if(printtype=="2x2"){var h=parseFloat(f/2)-parseFloat(e/2),i=parseFloat(g/2)-parseFloat(e/2);f-=e*2,g-=e*2;var j='<div class="gallery-handle" style="position: absolute; font-size: 0px; z-index: -1; width: '+e+"px; height: "+g+"px; left: "+h+"px; top: "+e+'px; "></div>',k='<div class="gallery-handle" style="position: absolute; font-size: 0px; z-index: -1; width: '+f+"px; height: "+e+"px; left: "+e+"px; top: "+i+'px; "></div>';$(".imgareaselect-border1").parent().append(j),$(".imgareaselect-border1").parent().append(k)}if(printtype=="1x3"){var l=parseFloat((a-e*4)/3),m=l+parseFloat(e),n=l*2+parseFloat(e*2),i=parseFloat(g/2)+parseFloat(e/2);g-=e*2;var j='<div class="gallery-handle" style="position: absolute; font-size: 0px; z-index: -1; width: '+e+"px; height: "+g+"px; left: "+m+"px; top: "+e+'px; "></div>',k='<div class="gallery-handle" style="position: absolute; font-size: 0px; z-index: -1; width: '+e+"px; height: "+g+"px; left: "+n+"px; top: "+e+'px; "></div>';$(".imgareaselect-border1").parent().append(j),$(".imgareaselect-border1").parent().append(k)}quality(a)}function quality(a){var b=currentImage.x/printwidth/(previewWidth/a);b>0&&(b>50?$(".quality").html("<span>Meget bra</span>"):b>20?$(".quality").html("<span>Bra</span>"):b>5?$(".quality").html('<span class="bad">D&#229;rlig</span>'):$(".quality").html('<span class="verybad">Meget d&#229;rlig</span>'))}function updateArtnr(){currentProductOptionId=$(".selectedsize option:selected").attr("id"),$(".quantity").trigger("change")}function inlineImageUploadCallback(a,b){b?pickImage(b):alert("Could not retrive image information"+a)}function save(a){printtype=$("#printtype").val(),printtype=="2x2"||printtype=="1x3"?framedepth=4:framedepth=printtype;var b=parseFloat(printwidth)+parseFloat(framedepth)*2,c=parseFloat(printheight)+parseFloat(framedepth)*2;page={},page.giftQuantity=$("#gift-quantity").val(),page.productoptionid=currentProductOptionId,page.size="small",page.redeye=!1,page.varnish=!1,$("#red-eye").is(":checked")&&(page.redeye="true"),$("#varnish").is(":checked")&&(page.varnish="true"),$("#upgrade").is(":checked")&&(page.upgrade=$("#upgrade").val());if(currentSelection.width==0)return alert("Du m&#229; velge et utsnitt!"),!1;page.image={},page.image.printtype=printtype,page.image.printsize_x=b,page.image.printsize_y=c,page.image.fullsize_x=currentImage.x,page.image.fullsize_y=currentImage.y,page.image.editor_x=previewWidth,page.image.editor_y=previewHeight,page.image.x=currentSelection.x1,page.image.y=currentSelection.y1,page.image.dx=currentSelection.width,page.image.dy=currentSelection.height,page.image.bid=currentImage.id;var d=[page];a?console.log($(d)):$.post("/create/enlargements/save",{pages:$.toJSON(d),web:!0},function(a){return document.location.href="/cart/accessories/",!1})}